# Spark History Server for Spark on EKS - Dev Environment
# Override base spark-history-server config from infra/argocd/data/spark-history-server/values.yaml

# Override base spark-history-server configuration
spark-history-server:
  # Dev resource settings (lower than production)
  resources:
    requests:
      cpu: 100m
      memory: 512Mi
    limits:
      cpu: 500m
      memory: 1Gi

  # Service configuration
  service:
    type: ClusterIP
    port: 18080

  # S3 configuration uses global parameters
  sparkHistoryOpts: "-Dspark.history.fs.logDirectory=s3a://{{ .Values.global.s3BucketName }}/spark-event-logs/"

  # Environment variables
  env:
    - name: AWS_REGION
      value: "{{ .Values.global.region }}"
    - name: SPARK_HISTORY_OPTS
      value: "-Dspark.history.fs.logDirectory=s3a://{{ .Values.global.s3BucketName }}/spark-event-logs/"

  # Dev monitoring
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "18080"
    
  # Add health checks for production readiness
  livenessProbe:
    httpGet:
      path: /
      port: 18080
    initialDelaySeconds: 30
    periodSeconds: 10
  
  readinessProbe:
    httpGet:
      path: /
      port: 18080
    initialDelaySeconds: 5
    periodSeconds: 5
