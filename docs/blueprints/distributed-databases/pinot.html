<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-blueprints/distributed-databases/pinot" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Deploying Apache Pinot (üç∑) on EKS | Data on EKS</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://awslabs.github.io/data-on-eks/docs/blueprints/distributed-databases/pinot><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Deploying Apache Pinot (üç∑) on EKS | Data on EKS"><meta data-rh=true name=description content="Apache Pinot is real-time distributed OLAP datastore, purpose built for low-latency and high-throughput analytics. You can use pinot to ingest and immediately query data from streaming or batch data sources e.g. Apache Kafka, Amazon Kinesis Data Streams, Amazon S3, etc)."><meta data-rh=true property=og:description content="Apache Pinot is real-time distributed OLAP datastore, purpose built for low-latency and high-throughput analytics. You can use pinot to ingest and immediately query data from streaming or batch data sources e.g. Apache Kafka, Amazon Kinesis Data Streams, Amazon S3, etc)."><link data-rh=true rel=icon href=/data-on-eks/img/header-icon.png><link data-rh=true rel=canonical href=https://awslabs.github.io/data-on-eks/docs/blueprints/distributed-databases/pinot><link data-rh=true rel=alternate href=https://awslabs.github.io/data-on-eks/docs/blueprints/distributed-databases/pinot hreflang=en><link data-rh=true rel=alternate href=https://awslabs.github.io/data-on-eks/docs/blueprints/distributed-databases/pinot hreflang=x-default><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://awslabs.github.io/data-on-eks/docs/category/distributed-databases-on-eks","name":"Distributed Databases on EKS","position":1},{"@type":"ListItem","item":"https://awslabs.github.io/data-on-eks/docs/blueprints/distributed-databases/pinot","name":"Apache Pinot","position":2}]}</script><link rel=stylesheet href=/data-on-eks/assets/css/styles.c8db921d.css><script src=/data-on-eks/assets/js/runtime~main.d9f1c0dc.js defer></script><script src=/data-on-eks/assets/js/main.825e5795.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/data-on-eks/><div class=navbar__logo><img src=/data-on-eks/img/header-icon.png alt="DoEKS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/data-on-eks/img/header-icon.png alt="DoEKS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/data-on-eks/docs/blueprints/data-analytics>Blueprints</a><a class="navbar__item navbar__link" href=/data-on-eks/docs/bestpractices/intro>Best Practices</a><a class="navbar__item navbar__link" href=/data-on-eks/docs/benchmarks/emr-on-eks>Benchmarks</a><a class="navbar__item navbar__link" href=/data-on-eks/docs/resources/intro>Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/awslabs/data-on-eks target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/data-on-eks/docs/category/data-analytics-on-eks>Data Analytics on EKS</a><button aria-label="Expand sidebar category 'Data Analytics on EKS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/data-on-eks/docs/category/amazon-emr-on-eks>Amazon EMR on EKS</a><button aria-label="Expand sidebar category 'Amazon EMR on EKS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/data-on-eks/docs/category/streaming-platforms-on-eks>Streaming Platforms on EKS</a><button aria-label="Expand sidebar category 'Streaming Platforms on EKS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/data-on-eks/docs/category/job-schedulers-on-eks>Job Schedulers on EKS</a><button aria-label="Expand sidebar category 'Job Schedulers on EKS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/data-on-eks/docs/category/distributed-databases-on-eks>Distributed Databases on EKS</a><button aria-label="Collapse sidebar category 'Distributed Databases on EKS'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases>Introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases/cloudnative-postgres>CloudNativePG PostgreSQL</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases/pinot>Apache Pinot</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases/trino>Trino on EKS</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases/clickhouse>ClickHouse</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/data-on-eks/docs/blueprints/distributed-databases/aerospike>Aerospike</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/data-on-eks/docs/blueprints/troubleshooting>Troubleshooting</a></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/data-on-eks/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/data-on-eks/docs/category/distributed-databases-on-eks><span>Distributed Databases on EKS</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Apache Pinot</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploying Apache Pinot (üç∑) on EKS</h1></header>
<p><a href=https://pinot.apache.org/ target=_blank rel="noopener noreferrer">Apache Pinot</a> is real-time distributed OLAP datastore, purpose built for low-latency and high-throughput analytics. You can use pinot to ingest and immediately query data from streaming or batch data sources e.g. Apache Kafka, Amazon Kinesis Data Streams, Amazon S3, etc).</p>
<p>Apache Pinot includes the following characteristics:</p>
<ul>
<li><strong>Ultra low-latency</strong> analytics even at extremely high throughput.</li>
<li><strong>Columnar data store</strong> with several smart indexing and pre-aggregation techniques.</li>
<li><strong>Scaling up</strong> and <strong>out</strong> with no upper bound.</li>
<li><strong>Consistent performance</strong> based on the size of your cluster and an expected query per second (QPS) threshold.</li>
</ul>
<p>It's a perfect solution for user-facing real-time analytics and other analytical use cases, including internal dashboards, anomaly detection, and ad hoc data exploration. You can learn more about Apache Pinot and its components in its <a href=https://docs.pinot.apache.org/ target=_blank rel="noopener noreferrer">documentation</a>.</p>
<p>In this blueprint, we will deploy Apache Pinot on Kubernetes cluster managed by Elastic Kubernetes Service (EKS). Some of the benefits of deploying Apache Pinot on EKS cluster are</p>
<ul>
<li>Manage Apache Pinot Cluster using Kubernetes</li>
<li>Scale each layer independently</li>
<li>No single point of failure</li>
<li>Auto recovery</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=architecture>Architecture<a href=#architecture class=hash-link aria-label="Direct link to Architecture" title="Direct link to Architecture">‚Äã</a></h2>
<p><img decoding=async loading=lazy alt="Apache Pinot on EKS" src=/data-on-eks/assets/images/pinot-on-eks-a79291223d852e1628ff508b31041ed3.png width=1606 height=808 class=img_ev3q></p>
<p>In this setup we deploy all Apache Pinot components in private subnets across 3 availability zones. This allows for greater flexibility and resilience. Most pinot components can run on latest generation general purpose compute instances (<code>m7i</code>) except for server component which requires memory optimized instance types (<code>r7i</code>). We also setup internal NLB to easily communicate with Controller and Broker components.</p>
<blockquote>
<p>Note: All Apache Pinot components run on <code>StatefulSet</code>.</p>
</blockquote>
<blockquote>
<p>Note: This blueprint doesn't leverage <a href=https://docs.pinot.apache.org/basics/components/table/segment/deep-store target=_blank rel="noopener noreferrer">DeepStore</a> currently and uses EBS volumes to store table segments on server.</p>
</blockquote>
<blockquote>
<p>Note: Based on your use case, you will need to update the cluster size and configuration to better suite your use case. You can read more about Apache Pinot capacity planning <a href=https://startree.ai/blog/capacity-planning-in-apache-pinot-part-1 target=_blank rel="noopener noreferrer">here</a> and <a href=https://startree.ai/blog/capacity-planning-in-apache-pinot-part-2 target=_blank rel="noopener noreferrer">here</a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=prerequisites->Prerequisites üìù<a href=#prerequisites- class=hash-link aria-label="Direct link to Prerequisites üìù" title="Direct link to Prerequisites üìù">‚Äã</a></h2>
<p>Ensure that you have following tools installed on your machine.</p>
<ol>
<li><a href=https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html target=_blank rel="noopener noreferrer">aws cli</a></li>
<li><a href=https://Kubernetes.io/docs/tasks/tools/ target=_blank rel="noopener noreferrer">kubectl</a></li>
<li><a href=https://learn.hashicorp.com/tutorials/terraform/install-cli target=_blank rel="noopener noreferrer">terraform</a></li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=deployment-Ô∏è>Deployment ‚öôÔ∏è<a href=#deployment-Ô∏è class=hash-link aria-label="Direct link to Deployment ‚öôÔ∏è" title="Direct link to Deployment ‚öôÔ∏è">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=deploy-the-eks-cluster-with-apache-pinot>Deploy the EKS Cluster with Apache Pinot<a href=#deploy-the-eks-cluster-with-apache-pinot class=hash-link aria-label="Direct link to Deploy the EKS Cluster with Apache Pinot" title="Direct link to Deploy the EKS Cluster with Apache Pinot">‚Äã</a></h3>
<p>First, clone the repository.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>git</span><span class="token plain"> clone https://github.com/awslabs/data-on-eks.git</span><br></span></code></pre></div></div>
<p>Navigate to apache pinot folder and create <code>terraform.tfvars</code> to provide desired values for all the variables. This is also the time to update any other input variables or make any other changes to the terraform template.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token builtin class-name">cd</span><span class="token plain"> data-on-eks/distributed-databases/pinot</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>touch</span><span class="token plain"> terraform.tfvars</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=sample-terraformtfvars>Sample <code>terraform.tfvars</code><a href=#sample-terraformtfvars class=hash-link aria-label="Direct link to sample-terraformtfvars" title="Direct link to sample-terraformtfvars">‚Äã</a></h4>
<div class="language-terraform codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-terraform codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">name                = "pinot-on-eks"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">region              = "us-west-2"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">eks_cluster_version = "1.25"</span><br></span><span class=token-line style=color:#393A34><span class="token plain">...</span><br></span></code></pre></div></div>
<p>Once you have updated your variables, you can run the install script to deploy your pre-configured EKS cluster with Apache Pinot.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">./install.sh</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=verify-deployment>Verify Deployment<a href=#verify-deployment class=hash-link aria-label="Direct link to Verify Deployment" title="Direct link to Verify Deployment">‚Äã</a></h3>
<p>Verify the Amazon EKS Cluster</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">aws eks describe-cluster </span><span class="token parameter variable" style=color:#36acaa>--name</span><span class="token plain"> pinot-on-eks</span><br></span></code></pre></div></div>
<p>Update local kubeconfig so we can access kubernetes cluster.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">aws eks update-kubeconfig </span><span class="token parameter variable" style=color:#36acaa>--name</span><span class="token plain"> pinot-on-eks </span><span class="token parameter variable" style=color:#36acaa>--region</span><span class="token plain"> us-west-2</span><br></span></code></pre></div></div>
<p>First, lets verify that we have worker nodes running in the cluster.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl get nodes</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=output>Output<a href=#output class=hash-link aria-label="Direct link to Output" title="Direct link to Output">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME                                         STATUS   ROLES    AGE   VERSION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ip-10-1-189-200.us-west-2.compute.internal   Ready    </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#393A34>></span><span class="token plain">   12d   v1.24.17-eks-43840fb</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ip-10-1-46-117.us-west-2.compute.internal    Ready    </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#393A34>></span><span class="token plain">   12d   v1.24.17-eks-43840fb</span><br></span><span class=token-line style=color:#393A34><span class="token plain">ip-10-1-84-80.us-west-2.compute.internal     Ready    </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">none</span><span class="token operator" style=color:#393A34>></span><span class="token plain">   12d   v1.24.17-eks-43840fb</span><br></span></code></pre></div></div>
<p>Next, lets verify all the pods are running.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl get pods </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> pinot</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=output-1>Output<a href=#output-1 class=hash-link aria-label="Direct link to Output" title="Direct link to Output">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME                                                   READY   STATUS      RESTARTS   AGE</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-broker-0                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-broker-1                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-broker-2                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-controller-0                                     </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-controller-1                                     </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-controller-2                                     </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-minion-stateless-86cf65f89-rlpwn                 </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-minion-stateless-86cf65f89-tkbjf                 </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-minion-stateless-86cf65f89-twp8n                 </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-server-0                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-server-1                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-server-2                                         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          11d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-zookeeper-0                                      </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-zookeeper-1                                      </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">pinot-zookeeper-2                                      </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running     </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span></code></pre></div></div>
<p>We have also deployed <code>prometheus</code> and <code>grafana</code> under <code>monitoring</code> namespace. So also make sure all the pods for <code>monitoring</code> are also running.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl get pods </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> monitoring</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=output-2>Output<a href=#output-2 class=hash-link aria-label="Direct link to Output" title="Direct link to Output">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">prometheus-grafana-85b4584dbf-4l72l                    </span><span class="token number" style=color:#36acaa>3</span><span class="token plain">/3     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-kube-prometheus-operator-84dcddccfc-pv8nv   </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-kube-state-metrics-57f6b6b4fd-txjtb         </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-prometheus-kube-prometheus-prometheus-0     </span><span class="token number" style=color:#36acaa>2</span><span class="token plain">/2     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          4d3h</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-prometheus-node-exporter-4jh8q              </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-prometheus-node-exporter-f5znb              </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span><span class=token-line style=color:#393A34><span class="token plain">prometheus-prometheus-node-exporter-f9xrz              </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">/1     Running   </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">          12d</span><br></span></code></pre></div></div>
<p>Now lets access Apache Pinot Console using the below command. Console consist of <strong>Cluster Manager</strong>, <strong>Query Explorer</strong>, <strong>Zookeeper Browser</strong> and <strong>Swagger REST API Explorer</strong>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl port-forward service/pinot-controller </span><span class="token number" style=color:#36acaa>9000</span><span class="token plain">:9000 </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> pinot</span><br></span></code></pre></div></div>
<p>This will allow you to access Apache Pinot Console like the one shown below using <code>http://localhost:9000</code></p>
<p><img decoding=async loading=lazy alt="Apache Pinot Web Console" src=/data-on-eks/assets/images/pinot-console-d384a9acdde6014e42e7420a9acee927.png width=1627 height=1098 class=img_ev3q></p>
<p>Apache Pinot supports exporting metrics using Prometheus JMX exporter that is packaged within the Apache Pinot docker image. Lets ensure metrics from all Apache Pinot components are getting published to <code>prometheus</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl port-forward service/prometheus-kube-prometheus-prometheus </span><span class="token number" style=color:#36acaa>9090</span><span class="token plain">:9090 </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> monitoring</span><br></span></code></pre></div></div>
<p>Navigate to the prometheus UI at <code>http://localhost:9090</code>, type <code>pinot</code> in the search box and you should be able to see all the metrics.</p>
<p><img decoding=async loading=lazy alt=Prometheus src=/data-on-eks/assets/images/prometheus-dfd8da6b8f9f675e3b5aec86726bcefe.png width=1650 height=675 class=img_ev3q></p>
<p>Next, Let's use Grafana to visualize the Apache Pinot metrics. In order to access Grafana, we need to get the grafana password from AWS Secrets Manager.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">aws secretsmanager get-secret-value --secret-id pinot-on-eks-grafana </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> jq </span><span class="token string" style=color:#e3116c>'.SecretString'</span><span class="token plain"> --raw-output</span><br></span></code></pre></div></div>
<p>Now use the port-forwarding to access Grafana at port <code>8080</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl port-forward service/prometheus-grafana </span><span class="token number" style=color:#36acaa>8080</span><span class="token plain">:80 </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> monitoring</span><br></span></code></pre></div></div>
<p>Login to grafana dashboard using <code>admin</code> and password retrieved in the previous step and then navigate to Dashboard and click New and then Import. Use the file <code>pinot.json</code> under <code>data-on-eks/distributed-database/pinot/dashboard</code> to create a pinot dashboard.</p>
<p><img decoding=async loading=lazy alt="Grafana Dashboard for Pinot" src=/data-on-eks/assets/images/grafana-1b023edced86ce564abe30bdc66e1058.png width=1650 height=1268 class=img_ev3q></p>
<p>To learn more about the monitoring of Apache Pinot using Prometheus and Grafana use the <a href=https://docs.pinot.apache.org/operators/tutorials/monitor-pinot-using-prometheus-and-grafana target=_blank rel="noopener noreferrer">official guide</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=additional-deployment-optional->Additional Deployment (Optional) üèÜ<a href=#additional-deployment-optional- class=hash-link aria-label="Direct link to Additional Deployment (Optional) üèÜ" title="Direct link to Additional Deployment (Optional) üèÜ">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=deploy-apache-kafka-for-streaming-data>Deploy Apache Kafka for Streaming Data<a href=#deploy-apache-kafka-for-streaming-data class=hash-link aria-label="Direct link to Deploy Apache Kafka for Streaming Data" title="Direct link to Deploy Apache Kafka for Streaming Data">‚Äã</a></h3>
<p>Apache Pinot can ingest data from streaming data sources (real-time) as well as batch data sources (offline). In this example, we will leverage <a href=https://kafka.apache.org/ target=_blank rel="noopener noreferrer">Apache Kafka</a> to push real-time data to a topic.</p>
<p>If you already have Apache Kafka running in your EKS cluster or you are leveraging Amazon Managed Streaming for Apache Kafka (MSK) you can skip this step. Otherwise, follow the steps below to install Kafka in your EKS cluster.</p>
<blockquote>
<p>Note: Following deployment configure Kafka Brokers with PLAINTEXT listeners for simplified deployment. Modify the <code>kafka-values.yaml</code> file for production deployment</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">helm repo </span><span class="token function" style=color:#d73a49>add</span><span class="token plain"> bitnami https://charts.bitnami.com/bitnami</span><br></span><span class=token-line style=color:#393A34><span class="token plain">helm </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> pinot pinot-kafka bitnami/kafka </span><span class="token parameter variable" style=color:#36acaa>--values</span><span class="token plain"> ./helm/kafka-values.yaml</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=output-3>Output<a href=#output-3 class=hash-link aria-label="Direct link to Output" title="Direct link to Output">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">NAME: pinot-kafka</span><br></span><span class=token-line style=color:#393A34><span class="token plain">LAST DEPLOYED: Tue Oct </span><span class="token number" style=color:#36acaa>24</span><span class="token plain"> 01:10:25 </span><span class="token number" style=color:#36acaa>2023</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">NAMESPACE: pinot</span><br></span><span class=token-line style=color:#393A34><span class="token plain">STATUS: deployed</span><br></span><span class=token-line style=color:#393A34><span class="token plain">REVISION: </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">TEST SUITE: None</span><br></span><span class=token-line style=color:#393A34><span class="token plain">NOTES:</span><br></span><span class=token-line style=color:#393A34><span class="token plain">CHART NAME: kafka</span><br></span><span class=token-line style=color:#393A34><span class="token plain">CHART VERSION: </span><span class="token number" style=color:#36acaa>26.2</span><span class="token plain">.0</span><br></span><span class=token-line style=color:#393A34><span class="token plain">APP VERSION: </span><span class="token number" style=color:#36acaa>3.6</span><span class="token plain">.0</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">** Please be patient </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> the chart is being deployed **</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Kafka can be accessed by consumers via port </span><span class="token number" style=color:#36acaa>9092</span><span class="token plain"> on the following DNS name from within your cluster:</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pinot-kafka.pinot.svc.cluster.local</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Each Kafka broker can be accessed by producers via port </span><span class="token number" style=color:#36acaa>9092</span><span class="token plain"> on the following DNS name</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">s</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> from within your cluster:</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pinot-kafka-controller-0.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pinot-kafka-controller-1.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pinot-kafka-controller-2.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">To create a pod that you can use as a Kafka client run the following commands:</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    kubectl run pinot-kafka-client </span><span class="token parameter variable" style=color:#36acaa>--restart</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'Never'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--image</span><span class="token plain"> docker.io/bitnami/kafka:3.6.0-debian-11-r0 </span><span class="token parameter variable" style=color:#36acaa>--namespace</span><span class="token plain"> pinot </span><span class="token parameter variable" style=color:#36acaa>--command</span><span class="token plain"> -- </span><span class="token function" style=color:#d73a49>sleep</span><span class="token plain"> infinity</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--tty</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-i</span><span class="token plain"> pinot-kafka-client </span><span class="token parameter variable" style=color:#36acaa>--namespace</span><span class="token plain"> pinot -- </span><span class="token function" style=color:#d73a49>bash</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    PRODUCER:</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        kafka-console-producer.sh </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            --broker-list pinot-kafka-controller-0.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092,pinot-kafka-controller-1.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092,pinot-kafka-controller-2.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token parameter variable" style=color:#36acaa>--topic</span><span class="token plain"> </span><span class="token builtin class-name">test</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    CONSUMER:</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        kafka-console-consumer.sh </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            --bootstrap-server pinot-kafka.pinot.svc.cluster.local:9092 </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token parameter variable" style=color:#36acaa>--topic</span><span class="token plain"> </span><span class="token builtin class-name">test</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            --from-beginning</span><br></span></code></pre></div></div>
<p>Use the command mentioned above to create <strong>Kafka Client</strong> pod within your namespace.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl run pinot-kafka-client </span><span class="token parameter variable" style=color:#36acaa>--restart</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'Never'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--image</span><span class="token plain"> docker.io/bitnami/kafka:3.6.0-debian-11-r0 </span><span class="token parameter variable" style=color:#36acaa>--namespace</span><span class="token plain"> pinot </span><span class="token parameter variable" style=color:#36acaa>--command</span><span class="token plain"> -- </span><span class="token function" style=color:#d73a49>sleep</span><span class="token plain"> infinity</span><br></span></code></pre></div></div>
<p>and then attach to the container shell</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--tty</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-i</span><span class="token plain"> pinot-kafka-client </span><span class="token parameter variable" style=color:#36acaa>--namespace</span><span class="token plain"> pinot -- </span><span class="token function" style=color:#d73a49>bash</span><br></span></code></pre></div></div>
<p>Create Kafka topics using the below commands, which will then be used to publish messages.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kafka-topics.sh --bootstrap-server pinot-kafka-controller-0.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092 </span><span class="token parameter variable" style=color:#36acaa>--topic</span><span class="token plain"> flights-realtime </span><span class="token parameter variable" style=color:#36acaa>--create</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--partitions</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> --replication-factor </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">kafka-topics.sh --bootstrap-server pinot-kafka-controller-0.pinot-kafka-controller-headless.pinot.svc.cluster.local:9092 </span><span class="token parameter variable" style=color:#36acaa>--topic</span><span class="token plain"> flights-realtime-avro </span><span class="token parameter variable" style=color:#36acaa>--create</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>--partitions</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> --replication-factor </span><span class="token number" style=color:#36acaa>1</span><br></span></code></pre></div></div>
<p>and then <code>exit</code> from the container shell</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token builtin class-name">exit</span><br></span></code></pre></div></div>
<p>Use provided <code>example/pinot-realtime-quickstart.yml</code> to create tables and publish sample data to the above topics, which will then get ingested into tables.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl apply </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> example/pinot-realtime-quickstart.yml</span><br></span></code></pre></div></div>
<p>Now, let's navigate back to <strong>Query Console</strong> and then click one of the tables. You should be able to see the newly created tables and data coming into tables.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">kubectl port-forward service/pinot-controller </span><span class="token number" style=color:#36acaa>9000</span><span class="token plain">:9000 </span><span class="token parameter variable" style=color:#36acaa>-n</span><span class="token plain"> pinot</span><br></span></code></pre></div></div>
<p><img decoding=async loading=lazy alt="Pinot Example" src=/data-on-eks/assets/images/pinot-example-ddd630a3c986e79b4ee18e7d3274e782.png width=1861 height=1131 class=img_ev3q></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=cleanup->Cleanup üßπ<a href=#cleanup- class=hash-link aria-label="Direct link to Cleanup üßπ" title="Direct link to Cleanup üßπ">‚Äã</a></h2>
<p>To delete all the components provisioned as part of this blueprint, using the following command to destroy all the resources.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">./cleanup.sh</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>To avoid unwanted charges to your AWS account, delete all the AWS resources created during this deployment<p>ex. Delete kafka-on-eks EBS volumes</div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/awslabs/data-on-eks/blob/main/website/docs/blueprints/distributed-databases/pinot.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/data-on-eks/docs/blueprints/distributed-databases/cloudnative-postgres><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>CloudNativePG PostgreSQL</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/data-on-eks/docs/blueprints/distributed-databases/trino><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Trino on EKS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#architecture class="table-of-contents__link toc-highlight">Architecture</a><li><a href=#prerequisites- class="table-of-contents__link toc-highlight">Prerequisites üìù</a><li><a href=#deployment-Ô∏è class="table-of-contents__link toc-highlight">Deployment ‚öôÔ∏è</a><ul><li><a href=#deploy-the-eks-cluster-with-apache-pinot class="table-of-contents__link toc-highlight">Deploy the EKS Cluster with Apache Pinot</a><li><a href=#verify-deployment class="table-of-contents__link toc-highlight">Verify Deployment</a></ul><li><a href=#additional-deployment-optional- class="table-of-contents__link toc-highlight">Additional Deployment (Optional) üèÜ</a><ul><li><a href=#deploy-apache-kafka-for-streaming-data class="table-of-contents__link toc-highlight">Deploy Apache Kafka for Streaming Data</a></ul><li><a href=#cleanup- class="table-of-contents__link toc-highlight">Cleanup üßπ</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Get Started</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/data-on-eks/docs/introduction/intro>Docs</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Get Involved</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/awslabs/data-on-eks target=_blank rel="noopener noreferrer" class=footer__link-item>Github<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Built with ‚ù§Ô∏è at AWS  <br> ¬© 2025 Amazon.com, Inc. or its affiliates. All Rights Reserved</div></div></div></footer><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "7fbc7ab02fae4767b1af2588eba0cdf2"}'></script></div>