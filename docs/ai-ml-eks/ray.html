<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ai-ml-eks/ray">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Ray on EKS | Data on EKS (DoEKS)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://awslabs.github.io/data-on-eks/docs/ai-ml-eks/ray"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ray on EKS | Data on EKS (DoEKS)"><meta data-rh="true" name="description" content="This blueprint should be considered as experimental and should only be used for proof of concept."><meta data-rh="true" property="og:description" content="This blueprint should be considered as experimental and should only be used for proof of concept."><link data-rh="true" rel="canonical" href="https://awslabs.github.io/data-on-eks/docs/ai-ml-eks/ray"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/data-on-eks/docs/ai-ml-eks/ray" hreflang="en"><link data-rh="true" rel="alternate" href="https://awslabs.github.io/data-on-eks/docs/ai-ml-eks/ray" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/data-on-eks/blog/rss.xml" title="Data on EKS (DoEKS) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-on-eks/blog/atom.xml" title="Data on EKS (DoEKS) Atom Feed"><link rel="stylesheet" href="/data-on-eks/assets/css/styles.a5ee1bb4.css">
<link rel="preload" href="/data-on-eks/assets/js/runtime~main.eeabdad3.js" as="script">
<link rel="preload" href="/data-on-eks/assets/js/main.b263dcf5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/data-on-eks/"><b class="navbar__title text--truncate">DoEKS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/intro">Welcome</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/amazon-emr-on-eks">EMR on EKS</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/spark-on-eks">Spark on EKS</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/ai-ml-eks">AI/ML</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/distributed-databases-eks">Distributed Databases</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/streaming-platforms-eks">Streaming Platforms</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/data-on-eks/docs/job-schedulers-eks">Job Schedulers</a><a class="navbar__item navbar__link" href="/data-on-eks/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/awslabs/data-on-eks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/data-on-eks/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-on-eks/docs/category/amazon-emr-on-eks">Amazon EMR on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Amazon EMR on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-on-eks/docs/category/apache-spark-on-eks">Apache Spark on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Apache Spark on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/data-on-eks/docs/category/aiml-on-eks">AI/ML on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;AI/ML on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/data-on-eks/docs/ai-ml-eks">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/data-on-eks/docs/ai-ml-eks/ray">Ray on EKS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-on-eks/docs/category/distributed-databases-on-eks">Distributed Databases on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Distributed Databases on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-on-eks/docs/category/streaming-platforms-on-eks">Streaming Platforms on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Streaming Platforms on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/data-on-eks/docs/category/job-schedulers-on-eks">Job Schedulers on EKS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Job Schedulers on EKS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/data-on-eks/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/data-on-eks/docs/category/aiml-on-eks"><span itemprop="name">AI/ML on EKS</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ray on EKS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Ray on EKS</h1><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This blueprint should be considered as experimental and should only be used for proof of concept.</p></div></div><p>This <a href="https://github.com/awslabs/data-on-eks/tree/main/ai-ml/terraform/ray" target="_blank" rel="noopener noreferrer">example</a> deploys an EKS Cluster running the <a href="https://docs.ray.io/en/latest/" target="_blank" rel="noopener noreferrer">Ray Operator</a>.</p><ul><li>Creates a new sample VPC, 3 Private Subnets and 3 Public Subnets</li><li>Creates Internet gateway for Public Subnets and NAT Gateway for Private Subnets</li><li>Creates EKS Cluster Control plane with public endpoint (for demo reasons only) with one managed node group</li><li>Deploys Ray Operator, AWS Load Balancer Controller, Ingress-nginx and External DNS (optional) add-ons</li><li>Deploys a Ray Cluster in the <code>ray-cluster</code> namespace</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><p>Ensure that you have installed the following tools on your machine.</p><ol><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" target="_blank" rel="noopener noreferrer">aws cli</a></li><li><a href="https://Kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">kubectl</a></li><li><a href="https://learn.hashicorp.com/tutorials/terraform/install-cli" target="_blank" rel="noopener noreferrer">terraform</a></li><li><a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">python3</a></li><li><a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq</a></li></ol><p>Additionally, for end-to-end configuration of Ingress, you can optionally provide the following:</p><ol><li>A <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-configuring.html" target="_blank" rel="noopener noreferrer">Route53 Public Hosted Zone</a> configured in the account where you are deploying this example. E.g. &quot;bar.com&quot;</li><li>An <a href="https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html" target="_blank" rel="noopener noreferrer">ACM Certificate</a> in the account + region where you are deploying this example. A wildcard certificate is preferred, e.g. &quot;*.bar.com&quot;</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-eks-cluster-with-ray-operator">Deploy the EKS Cluster with Ray Operator<a class="hash-link" href="#deploy-the-eks-cluster-with-ray-operator" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clone-the-repository">Clone the repository<a class="hash-link" href="#clone-the-repository" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/awslabs/data-on-eks.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-docker-image-for-ray-cluster">Build Docker Image for Ray Cluster<a class="hash-link" href="#build-docker-image-for-ray-cluster" title="Direct link to heading">​</a></h3><p>First, in order to run the RayCluster, we need to push a container image to ECR repository that contains the all the dependencies. You can see the <code>Dockerfile</code> in the example with python dependencies packaged in. The next series of steps we will setup an ECR repository, build the docker image for our model and push it to the ECR repository.</p><p>Create an ECR repository</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws ecr create-repository --repository-name ray-demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Login to the ECR repository</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">AWS_REGION</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">enter-your-region</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ACCOUNT_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">aws sts get-caller-identity </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> jq -r </span><span class="token variable string" style="color:#e3116c">&#x27;.Account&#x27;</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws ecr get-login-password </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --region </span><span class="token variable" style="color:#36acaa">$AWS_REGION</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> login </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --username AWS </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --password-stdin </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain">.dkr.ecr.</span><span class="token variable" style="color:#36acaa">$AWS_REGION</span><span class="token plain">.amazonaws.com/ray-demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Build the docker image containing our model deployment.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build sources -t </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain">.dkr.ecr.</span><span class="token variable" style="color:#36acaa">$AWS_REGION</span><span class="token plain">.amazonaws.com/ray-demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Push the docker image to the ECR repo</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> push </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain">.dkr.ecr.</span><span class="token variable" style="color:#36acaa">$AWS_REGION</span><span class="token plain">.amazonaws.com/ray-demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="initialize-terraform">Initialize Terraform<a class="hash-link" href="#initialize-terraform" title="Direct link to heading">​</a></h3><p>Navigate into the example directory and run <code>terraform init</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> data-on-eks/ai-ml/terraform/ray/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="terraform-plan">Terraform Plan<a class="hash-link" href="#terraform-plan" title="Direct link to heading">​</a></h3><p>Run Terraform plan to verify the resources created by this execution.</p><p><strong>Optional</strong> - provide a Route53 Hosted Zone hostname and a corresponding ACM Certificate;</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">TF_VAR_eks_cluster_domain</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;bar.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">TF_VAR_acm_certificate_domain</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;*.bar.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-pattern">Deploy the pattern<a class="hash-link" href="#deploy-the-pattern" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">terraform apply</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Outputs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configure_kubectl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;aws eks --region us-west-2 update-kubeconfig --name ray&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3_bucket </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ray-demo-models-20220719224423900800000001&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Enter <code>yes</code> to apply.</p><p>Export the s3_bucket to your local environment.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">S3_BUCKET</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;s3://ray-demo-models-20220719224423900800000001&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-deployment">Verify Deployment<a class="hash-link" href="#verify-deployment" title="Direct link to heading">​</a></h3><p>Update kubeconfig</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws eks --region us-west-2 update-kubeconfig --name ray</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify all pods are running.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE               NAME                                                        READY   STATUS    RESTARTS        AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external-dns            external-dns-99dd9564f-8fsvd                                </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingress-nginx           ingress-nginx-controller-659678ccb9-dlc5r                   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h20m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   alertmanager-kube-prometheus-stack-alertmanager-0           </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/2     Running   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-grafana-68d4b6d7f4-h97j4              </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">/3     Running   </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   15d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-kube-state-metrics-6d6b967d6d-fc62f   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-operator-7c8bffbd9b-5rv59             </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   14d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-prometheus-node-exporter-4hj6g        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h20m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-prometheus-node-exporter-9pgqc        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   kube-prometheus-stack-prometheus-node-exporter-v46pf        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-prometheus-stack   prometheus-kube-prometheus-stack-prometheus-0               </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/2     Running   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   14d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             aws-load-balancer-controller-67b5dd7d69-jjq4r               </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             aws-load-balancer-controller-67b5dd7d69-pthpn               </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h20m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             aws-node-7bcvh                                              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h19m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             aws-node-csshj                                              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h19m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             aws-node-htcmn                                              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h19m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             coredns-7f5998f4c-m4lxr                                     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             coredns-7f5998f4c-t78m9                                     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h20m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             kube-proxy-4v4pr                                            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             kube-proxy-7rkb7                                            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h20m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system             kube-proxy-v76mj                                            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kuberay-operator        kuberay-operator-7b88c9c4fb-kdhlz                           </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">6h21m ago</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   16d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ray-cluster             raycluster-autoscaler-head-wxbgw                            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">               10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ray-cluster             raycluster-autoscaler-worker-large-group-twtld              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1     Running   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">               10m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ray-dashboard">Ray Dashboard<a class="hash-link" href="#ray-dashboard" title="Direct link to heading">​</a></h4><p>The Ray Dashboard can be opened at the following url &quot;<a href="https://ray-demo.bar.com/dashboard%22" target="_blank" rel="noopener noreferrer">https://ray-demo.bar.com/dashboard&quot;</a></p><p><img loading="lazy" alt="Ray Dashboard" src="/data-on-eks/assets/images/ray-88e1cd5b5651d51bbe20e1ff0a41f102.png" width="1920" height="953" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a class="hash-link" href="#examples" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hugging-face">Hugging Face<a class="hash-link" href="#hugging-face" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ray-serve">Ray Serve<a class="hash-link" href="#ray-serve" title="Direct link to heading">​</a></h5><p>As a sample, we will use <a href="https://docs.ray.io/en/latest/serve/index.html" target="_blank" rel="noopener noreferrer">Ray Serve</a> to deploy a sample machine learning model and expose it to the outside world via the Ingress configuration. The code for this deployment can be found <code>sources/hface_t5_summarize_serve.py</code>. We use the <a href="https://huggingface.co/docs/transformers/model_doc/t5" target="_blank" rel="noopener noreferrer">Hugging Face T5</a> model to serve an endpoint to summarize an arbitrary block of text. This model is deployed as Kubernetes job <code>sample-jobs/summarize-serve-job.yaml</code>.</p><p>Create a Job to deploy the model to the Ray Cluster</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">envsubst </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> sample-jobs/summarize-serve-job.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubectl create -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">job.batch/ray-summarize-job-cjdd8 created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Tail the logs of the job to verify successful deployment of the job.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs -n ray-cluster ray-summarize-job-cjdd8-wmxm8 -f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Caught schedule exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-07-08 </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:03:29,579 INFO common.py:220 -- Exception from actor creation is ignored </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> destructor. To receive this exception </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> application code, call a method on the actor reference before its destructor is run.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ServeController </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">458</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> INFO </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-07-08 </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:03:30,684 controller </span><span class="token number" style="color:#36acaa">458</span><span class="token plain"> checkpoint_path.py:17 - Using RayInternalKVStore </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> controller checkpoint and recovery.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ServeController </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">458</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> INFO </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-07-08 </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:03:30,788 controller </span><span class="token number" style="color:#36acaa">458</span><span class="token plain"> http_state.py:115 - Starting HTTP proxy with name </span><span class="token string" style="color:#e3116c">&#x27;SERVE_CONTROLLER_ACTOR:SERVE_PROXY_ACTOR-node:10.0.12.204-0&#x27;</span><span class="token plain"> on </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;node:10.0.12.204-0&#x27;</span><span class="token plain"> listening on </span><span class="token string" style="color:#e3116c">&#x27;0.0.0.0:8000&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HTTPProxyActor </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">496</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> INFO:     Started server process </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">496</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ServeController </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">458</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> INFO </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-07-08 </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:03:33,701 controller </span><span class="token number" style="color:#36acaa">458</span><span class="token plain"> deployment_state.py:1217 - Adding </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> replicas to deployment </span><span class="token string" style="color:#e3116c">&#x27;Summarizer&#x27;</span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading: </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████████</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.17k/1.17k </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">.04MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">          </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain">/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?, ?B/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">▏         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.68M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">59</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">▍         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token plain">.4M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:04, </span><span class="token number" style="color:#36acaa">47</span><span class="token plain">.3MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:   </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">▋         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">.0M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:04, </span><span class="token number" style="color:#36acaa">45</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:   </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">▉         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">.5M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:04, </span><span class="token number" style="color:#36acaa">45</span><span class="token plain">.9MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">11</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token plain">.8M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:04, </span><span class="token number" style="color:#36acaa">48</span><span class="token plain">.9MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█▎        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token plain">.1M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:04, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█▌        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">36</span><span class="token plain">.4M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.7MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█▊        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">41</span><span class="token plain">.5M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.7MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain">.6M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.1MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██▏       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.5M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">25</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██▍       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token plain">.6M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.9MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">27</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██▋       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token plain">.7M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.3MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">29</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██▉       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token plain">.9M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">31</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">.0M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.1MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">33</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███▎      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token plain">.9M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:03, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">36</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███▌      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">82</span><span class="token plain">.2M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">38</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███▊      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">87</span><span class="token plain">.3M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.6MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">40</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token plain">.6M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">42</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████▏     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token plain">.7M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">45</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████▍     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 103M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">47</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████▋     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 108M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">49</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████▉     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 114M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.3MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████▏    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 119M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.6MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████▎    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 124M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:02, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.8MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">56</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████▌    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 129M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">58</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████▊    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 135M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.7MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">61</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 140M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">63</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████▎   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 145M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">65</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████▌   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 150M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.9MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">67</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████▋   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 155M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">44</span><span class="token plain">.7MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">70</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████▉   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 161M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">48</span><span class="token plain">.3MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███████▏  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 167M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">51</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">74</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███████▍  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 172M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.3MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">77</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███████▋  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 177M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:01, </span><span class="token number" style="color:#36acaa">50</span><span class="token plain">.8MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">79</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">███████▉  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 182M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">81</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████████▏ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 188M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">84</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████████▎ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 193M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.2MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">86</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████████▌ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 198M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.9MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">88</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">████████▊ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 204M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.6MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">90</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████████ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 209M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">53</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">93</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████████▎</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 214M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.0MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">95</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████████▍</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 219M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.6MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading:  </span><span class="token number" style="color:#36acaa">97</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">█████████▋</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 225M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.8MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading: </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████████</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 231M/231M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading: </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████████</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 773k/773k </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">29</span><span class="token plain">.1MB/s</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading: </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">%</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">██████████</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.32M/1.32M </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">00:0</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00, </span><span class="token number" style="color:#36acaa">25</span><span class="token plain">.5MB/s</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="test-summarize-deployment">Test Summarize Deployment<a class="hash-link" href="#test-summarize-deployment" title="Direct link to heading">​</a></h5><p>The client code uses python <code>requests</code> module to invoke the <code>/summarize</code> endpoint with a block of text. If all goes well, the endpoint should return summarized text of the block text submitted.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python sources/summarize_client.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">two astronauts steered their fragile lunar module safely and smoothly to the historic landing </span><span class="token builtin class-name">.</span><span class="token plain"> the first men to reach the moon -- Armstrong and his co-pilot, col. Edwin E. Aldrin Jr. of the air force -- brought their ship to rest on a level, rock-strewn plain </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pytorch-huggingface-clothing">Pytorch HuggingFace Clothing<a class="hash-link" href="#pytorch-huggingface-clothing" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ray-train">Ray Train<a class="hash-link" href="#ray-train" title="Direct link to heading">​</a></h5><p>As a sample, we will use <a href="https://docs.ray.io/en/latest/train/train.html" target="_blank" rel="noopener noreferrer">Ray Train</a> to train a machine learning model using a sample dataset. See the code for model training <code>sources/train_pytorch_huggingface_clothing.py</code></p><p>Create a Job to submit the training job to the Ray Cluster</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">envsubst </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> sample-jobs/train-pytorch-huggingface-clothing.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubectl create -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">job.batch/ray-train-pytorch-huggingface-clothing-plkzf created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Tail the logs to see the training in progress:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs -n ray-cluster job.batch/ray-train-pytorch-huggingface-clothing-plkzf -f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;running_train_loss&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.1093</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">requires_grad</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;_timestamp&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1660890352</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;_time_this_iter_s&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32.8163115978241</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;_training_iteration&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;time_this_iter_s&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37.8390429019928</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;should_checkpoint&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> True, </span><span class="token string" style="color:#e3116c">&#x27;done&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> True, </span><span class="token string" style="color:#e3116c">&#x27;timesteps_total&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> None, </span><span class="token string" style="color:#e3116c">&#x27;episodes_total&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> None, </span><span class="token string" style="color:#e3116c">&#x27;training_iteration&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;trial_id&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;af450_00000&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;experiment_id&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;5a41dbb6558648d29ff5070c391167ea&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;date&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2022-08-18_23-25-54&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1660890354</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;time_total_s&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37.8390429019928</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;pid&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1469</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;hostname&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;raycluster-autoscaler-head-wxbgw&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;node_ip&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;10.0.11.68&#x27;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;config&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;time_since_restore&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37.8390429019928</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;timesteps_since_restore&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;iterations_since_restore&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;warmup_time&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.002658843994140625</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&#x27;experiment_tag&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s3://ray-demo-models-20220801234005040500000001/ray_output/TorchTrainer_2022-08-18_23-25-13/TorchTrainer_af450_00000_0_2022-08-18_23-25-14/checkpoint_000000/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As shown above a model checkpoint is written to an S3 location so that it can be retrived for model serving. The location of the checkpoint is stored in the SSM Parameter Store.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ray-serve-1">Ray Serve<a class="hash-link" href="#ray-serve-1" title="Direct link to heading">​</a></h5><p>To create an inference endpoint which will be served using Ray Serve, create a Job to submit the Ray deployment <code>sources/serve_pytorch_huggingface_clothing.py</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">envsubst </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> sample-jobs/serve-pytorch-huggingface-clothing.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubectl create -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="test-deployment">Test Deployment<a class="hash-link" href="#test-deployment" title="Direct link to heading">​</a></h5><p>A sample script <code>sources/pytorch_huggingface_clothing_client.py</code> is provided that uses the requests library to test the inference endpoint.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python sources/pytorch_huggingface_clothing_client.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Positive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a class="hash-link" href="#monitoring" title="Direct link to heading">​</a></h3><p>This blueprint uses the <code>kube-prometheus-stack</code> to create a monitoring stack for getting visibility into your RayCluster.</p><p>Open the Grafana dashboard using the url &quot;<a href="https://ray-demo.bar.com/monitoring%22" target="_blank" rel="noopener noreferrer">https://ray-demo.bar.com/monitoring&quot;</a>. The sample Ray dashboard can be accessed by browsing to the Ray grafana folder.</p><p><img loading="lazy" alt="Ray Grafana Dashboard" src="/data-on-eks/assets/images/ray-grafana-0e24477b2a1da7e886df8c5bdc3100e8.png" width="1917" height="916" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cleanup">Cleanup<a class="hash-link" href="#cleanup" title="Direct link to heading">​</a></h2><p>To clean up your environment, destroy the Terraform modules in reverse order.</p><p>Destroy the Kubernetes Add-ons, EKS cluster with Node groups and VPC</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">terraform destroy -target</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;module.eks_blueprints_kubernetes_addons&quot;</span><span class="token plain"> -auto-approve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform destroy -target</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;module.eks_blueprints&quot;</span><span class="token plain"> -auto-approve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform destroy -target</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;module.vpc&quot;</span><span class="token plain"> -auto-approve</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, destroy any additional resources that are not in the above modules</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">terraform destroy -auto-approve</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/awslabs/data-on-eks/blob/main/website/docs/ai-ml-eks/ray.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/data-on-eks/docs/ai-ml-eks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/data-on-eks/docs/category/distributed-databases-on-eks"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Distributed Databases on EKS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#deploy-the-eks-cluster-with-ray-operator" class="table-of-contents__link toc-highlight">Deploy the EKS Cluster with Ray Operator</a><ul><li><a href="#clone-the-repository" class="table-of-contents__link toc-highlight">Clone the repository</a></li><li><a href="#build-docker-image-for-ray-cluster" class="table-of-contents__link toc-highlight">Build Docker Image for Ray Cluster</a></li><li><a href="#initialize-terraform" class="table-of-contents__link toc-highlight">Initialize Terraform</a></li><li><a href="#terraform-plan" class="table-of-contents__link toc-highlight">Terraform Plan</a></li><li><a href="#deploy-the-pattern" class="table-of-contents__link toc-highlight">Deploy the pattern</a></li><li><a href="#verify-deployment" class="table-of-contents__link toc-highlight">Verify Deployment</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li></ul></li><li><a href="#cleanup" class="table-of-contents__link toc-highlight">Cleanup</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Get Started</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/data-on-eks/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Get Involved</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/awslabs/data-on-eks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/data-on-eks/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS  <br> © 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved</div></div></div></footer></div>
<script src="/data-on-eks/assets/js/runtime~main.eeabdad3.js"></script>
<script src="/data-on-eks/assets/js/main.b263dcf5.js"></script>
</body>
</html>